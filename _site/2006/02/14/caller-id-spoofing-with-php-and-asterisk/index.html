<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" /
    <meta name="description" content="Software, PHP, MySQL, XMPP, Hacking, Baphomet" />
    <meta name="keywords" content="" />
    <meta name="robots" content="noodp,noydir" />
    <title> Caller id spoofing with PHP and asterisk |  Harper Reed: Tech, Mobile, Yo-yoing and Death Metal</title> 
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.7.0/jquery-ui.min.js"></script>

    <link href="http://www.nata2.org/atom.xml" rel="alternate" title="Harper Reed: Tech, Mobile, Yo-yoing and Death Metal" type="application/atom+xml" />
    <link rel="stylesheet" href="/css/style.css" type="text/css">

    <META name="verify-v1" content="bxsrf6C7p0+qY6MxNCbSNSGdkeDA8dQSxjTsNJu4Sa0=" />

    <link rel="openid.server" href="http://www.myopenid.com/server" />
    <meta name="myid" content="0eda4814-55e0-4756-bf30-0f1bf5a4b469" />
    <link rel="openid.delegate" href="http://harper.myopenid.com/" />

    <link rel="shorcut icon" type="image/x-ico" href="/favicon.ico" />

</head> 
<body>

<!-- bgcontain START -->
<div id="bgcontain">

    <!-- header START -->
    <div class="HeaderBG">
        <div class="Header">
            <h1><a href="http://www.nata2.org">Harper Reed: Tech, Mobile, Yo-yoing and Death Metal</a></h1>
<div class="Desc">Software, PHP, MySQL, XMPP, Hacking, Baphomet</div>  

        </div> 
    </div> 
    <!-- header END -->

    <!-- containerBG START -->
    <div class="ContainerBG">
        <!-- container START -->
        <div class="Container"> 
            <!-- Side Central START -->
            <div class="SC">
            <div class="Post" style="padding-bottom: 50px;">
    <div class="PostHead">
        <h1 class="title"><a title="Permanent Link to Caller id spoofing with PHP and asterisk." href="/2006/02/14/caller-id-spoofing-with-php-and-asterisk/" rel="bookmark">Caller id spoofing with PHP and asterisk</a></h1>
        <p class="PostDate">
            <strong class="day">14</strong>
            <strong class="month">Feb</strong>
        </p>
        
        <br />
        
    </div>
    <div class="PostContent">
        <p>I have cleaned up and commented a little hack i did for my home asterisk server - allowing a person to dial an extension and then be walked through spoofing caller id on a call. It is a ridiculously easy hack to engage. I was surprised and a bit concerned at what this means in regards to trust and telephony. I mean, if a hobbyist is able to spoof caller id on a phone call to anywhere with nothing more than <a href="http://asteriskathome.sourceforge.net/">asterisk@home</a> and <a href="http://www.vmware.com/products/server/">vmware</a>.. what is to stop someone from setting something like this up and stealing credit cards or social security numbers using some crazy <a href="http://en.wikipedia.org/wiki/Social_engineering_%28computer_security%29">social engineering</a>.. i guess nothing.. So anyway, i released <a href="http://asteriskathome.sourceforge.net/">my source code</a>. It is really really simple and based entirely on one small block of code. The basic idea is:</p>

<blockquote>
<ol>
<li><small>Prompt user for input (spoofed number)</small></li>
<li><small>Grab 10 digits (spoofed number)</small></li>
<li><small>Prompt user for input (number to call)</small></li>
<li><small>Grab 10 digits (number to call)</small></li>
<li><small>Set caller idea based on input in step 1 and 2</small></li>
<li><small>Make call to number from input in step 3 and 4</small></li>
</ol>
</blockquote>


<p>As you can see the idea is pretty simple. get input. set callerid. make call. The code is just as simple:</p>

<blockquote><small><span style="font-style: italic">//(step 1) Prompt user for input</span> $agi-&gt;stream_file('enter_spoof'); <span style="font-style: italic">//(step 2) Grab 10 digits</span> $result = $agi-&gt;get_data('beep', 3000, 10); <span style="font-style: italic">//set variables and output debug info</span> $spoofnumber= $result['result']; $agi-&gt;verbose("Spoof Number:".$spoofnumber);</small> <small><span style="font-style: italic">//(step 3) Prompt user for input</span> $agi-&gt;stream_file('call_spoof'); <span style="font-style: italic">//(step 4) Grab 10 digits</span> $result = $agi-&gt;get_data('beep', 3000, 10); <span style="font-style: italic">//set variables and output debug info</span> $callnumber= $result['result']; $agi-&gt;verbose("Number to call:".$callnumber); <span style="font-style: italic">//(step 5) Set callerid to whatever the input was in step 2</span> $agi-&gt;set_callerid($spoofnumber); <span style="font-style: italic">//(step 6) Make call to number from input in step 3 and 4 $agi-&gt;exec("Dial IAX2/yourpassword@provider/1".$callnumber);</span></small></blockquote>


<p>The agi interface to asterisk obviously hides a lot of the complex stuff that asterisk does in the background - but still - the code is insanely simple. even with user interaction. A lot of features could be added - password; callerid checking to make sure only valid users are using the app; call back - so if you call it and set up your spoof, it calls back your number to make sure you who you say you are. or whatever ;) a lot of options are available. With a little bit of expansion - i think someone could easily make a robust callerid spoofing application for criminals and not criminals. it is easy enough for anyone to do. Check out my code here: <a href="http://stuff.harperreed.org/?path=code%2Fasterisk_callerspoof_php&amp;text=asterisk_callerspoof.phps">asterisk_callerspoof</a> What i have done is nothing new - there is a great article about all this: <a href="http://www.rootsecure.net/?p=reports/callerid_spoofing">Automated Caller ID / ANI Spoofing</a> asterisk and php rule.</p>



        <div class="RelatedPosts"> 
            <h3>Related Posts</h3> 
            <ul>
                
                <li><a href="/2009/01/11/seven-things-goddamn-internet-friends/">Seven Things (goddamn internet friends)</a></li>
                
                <li><a href="/2008/03/11/those-parties-were-awesome/">Those parties were awesome!</a></li>
                
                <li><a href="/2007/10/17/a-email-response-from-a-friend/">A email response from a friend</a></li>
                
                <li><a href="/2007/06/27/goddamn-stoners/">Goddamn Stoners!</a></li>
                
                <li><a href="/2007/04/12/a-sad-day-rip-kurt-vonnegut/">A Sad Day. RIP Kurt Vonnegut.</a></li>
                
            </ul>
        </div> 


        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_identifier= '';
            var disqus_developer = 1;
          (function() {
           var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
           dsq.src = 'http://nata2.disqus.com/embed.js';
           (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=nata2">comments powered by Disqus.</a></noscript>

     </div>
</div>


            </div>
            <!--  Side Central END -->

            <!-- Side Right - START -->
            <div class="SR">
             <div class="SCtop"><div></div></div>
<div class="SCcontent"> 
    Liquid error: No such file or directory - ./_includes
     <div class="SRL"> 
        Liquid error: No such file or directory - ./_includes
        Liquid error: No such file or directory - ./_includes
        Liquid error: No such file or directory - ./_includes
        Liquid error: No such file or directory - ./_includes
    </div> 
    <div class="SRR"> 
        Liquid error: No such file or directory - ./_includes
        Liquid error: No such file or directory - ./_includes
 </div> 
</div> 
<div class="clear"></div> 
<div class="SCbottom"><div></div></div> 


            </div>
            <!-- Side Right - END  -->
        </div> 
        <!-- container END -->
    </div> 
    <!-- containerBG END -->


    <!-- ExtraBG Start -->
    <div class="ExtraBG">
        <!-- Extra Start -->
        <div class="Extra">
           <!-- RecentPosts Start -->
            <div class="RecentPosts">
                <h3>Recent Entries</h3>
                <div id="recententries" class="dsq-widget">
                <ul>
                  
                    <li>
                      Jan 11, 2009 &mdash; <a href="/2009/01/11/seven-things-goddamn-internet-friends/">Seven Things (goddamn internet friends)</a>
                    </li>
                  
                    <li>
                      Mar 11, 2008 &mdash; <a href="/2008/03/11/those-parties-were-awesome/">Those parties were awesome!</a>
                    </li>
                  
                    <li>
                      Oct 17, 2007 &mdash; <a href="/2007/10/17/a-email-response-from-a-friend/">A email response from a friend</a>
                    </li>
                  
                    <li>
                      Jun 27, 2007 &mdash; <a href="/2007/06/27/goddamn-stoners/">Goddamn Stoners!</a>
                    </li>
                  
                    <li>
                      Apr 12, 2007 &mdash; <a href="/2007/04/12/a-sad-day-rip-kurt-vonnegut/">A Sad Day. RIP Kurt Vonnegut.</a>
                    </li>
                  
                    <li>
                      Mar 31, 2007 &mdash; <a href="/2007/03/31/my-upgrade-wordpress-script/">My upgrade wordpress script</a>
                    </li>
                  
                    <li>
                      Jan 19, 2007 &mdash; <a href="/2007/01/19/chocolate-vegan-cake/">Chocolate Vegan Cake</a>
                    </li>
                  
                    <li>
                      Sep 24, 2006 &mdash; <a href="/2006/09/24/hacking-voicemail-with-asterisk-and-caller-id-spoofing/">Hacking mobile voicemail with Asterisk and caller ID spoofing</a>
                    </li>
                  
                    <li>
                      Apr 11, 2006 &mdash; <a href="/2006/04/11/38-s60-tips-and-tricks/">38 S60 tips and tricks </a>
                    </li>
                  
                    <li>
                      Feb 14, 2006 &mdash; <a href="/2006/02/14/caller-id-spoofing-with-php-and-asterisk/">Caller id spoofing with PHP and asterisk</a>
                    </li>
                  
                  </ul>
              </div>
                
            </div>
            <!-- RecentPosts END -->

            <!-- LastComments Start -->
            <div class="LastComments">
                <div id="recentcomments" class="dsq-widget"><h3 class="dsq-widget-title">Recent Comments</h3><script type="text/javascript" src="http://disqus.com/forums/nata2/recent_comments_widget.js?num_items=5&hide_avatars=1&avatar_size=32&excerpt_length=100"></script></div>
            </div>
            <!-- LastComments END -->

            <!-- MostCommented Start -->
            <div class="MostCommented">
                <div id="popularthreads" class="dsq-widget"><h3 class="dsq-widget-title">Popular Threads</h3><script type="text/javascript" src="http://disqus.com/forums/nata2/popular_threads_widget.js?num_items=5"></script></div>
            </div>
            <!-- MostCommented END -->
 
        </div>
        <!-- Extra END -->
    </div>
    <!-- ExtraBG END -->

    <div class="FooterBG">
        <div class="Footer">
        <p><a href="/">Nata2.org</a> is &copy; 1997-2010 <a href="http://www.harperreed.org/contact/">Harper Reed</a>. Theme stoled and inspired by the great <a href="http://bloggingpro.com/">BloggingPro</a> theme by: <a href="http://designdisease.com">Design Disease</a>. Powered by <a href="http://jekyllrb.com/">Jekyll</a>.</p>

        </div>
    </div>

</div>
<!-- bgcontain END-->

<script type="text/javascript" src="/js/scripts.js"></script>
 
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-70650-9");
pageTracker._trackPageview();
} catch(err) {}
</script>
 

<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/harper.json?callback=twitterCallback2&amp;count=5"></script>

<script type="text/javascript">
//<![CDATA[
(function() {
	var links = document.getElementsByTagName('a');
	var query = '?';
	for(var i = 0; i < links.length; i++) {
	if(links[i].href.indexOf('#disqus_thread') >= 0) {
		query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
	}
	}
	document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/nata2/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>

<script type="text/javascript">
var _sf_async_config={uid:5483,domain:"nata2.org"};
(function(){
  function loadChartbeat() {
    window._sf_endpt=(new Date()).getTime();
    var e = document.createElement('script');
    e.setAttribute('language', 'javascript');
    e.setAttribute('type', 'text/javascript');
    e.setAttribute('src',
       (("https:" == document.location.protocol) ? "https://s3.amazonaws.com/" : "http://") +
       "static.chartbeat.com/js/chartbeat.js");
    document.body.appendChild(e);
  }
  var oldonload = window.onload;
  window.onload = (typeof window.onload != 'function') ?
     loadChartbeat : function() { oldonload(); loadChartbeat(); };
})();
</script>

</body>
</html>
