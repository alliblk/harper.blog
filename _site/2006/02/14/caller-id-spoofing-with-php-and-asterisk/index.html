<!DOCTYPE html>
<html lang="en">
  <head>
    <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
    <meta charset="utf-8">
    <title> Caller id spoofing with PHP and asterisk |  Harper Reed: Technology and death metal</title>
    <meta name="description" content="Hacking, Baphomet and the real time internet" />
    <meta name="keywords" content="" />
    <meta name="author" content="Harper Reed: harper@nata2.org">
    <meta name="robots" content="noodp,noydir" />
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="/css/bootstrap.min.css?9" rel="stylesheet">
    <link href="/css/styles.css?9" rel="stylesheet">
    
    <link href="/css/bootstrap-responsive.css?7" rel="stylesheet">
    
    <META name="verify-v1" content="bxsrf6C7p0+qY6MxNCbSNSGdkeDA8dQSxjTsNJu4Sa0=" />
    <link rel="openid.server" href="http://www.myopenid.com/server" />
    <meta name="myid" content="0eda4814-55e0-4756-bf30-0f1bf5a4b469" />
    <link rel="openid.delegate" href="http://harper.myopenid.com/" />
    <link href="http://feeds.feedburner.com/HarperReed" rel="alternate" title="Harper Reed: Technology and death metal" type="application/atom+xml" />
    <link rel="shortcut icon" href="/favicon.ico">
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="offset2 span8 header"><h1><a href="http://www.nata2.org">Harper Reed: Technology and death metal</a></h1>
<small>Hacking, Baphomet and the real time internet</small>
</div>
      </div>
      <hr class="offset2 span8" /> 
      <div class="row">
        <div class="offset2 span8 muted well-small well"> <a href="http://en.wikipedia.org/wiki/Hacker_(programmer_subculture)" target="_blank"><img style="padding-right: 5px; margin: 0px" src="/images/glider.png" align="left"></a>

<strong>Hi.</strong> I am an engineer who builds paradigm-shifting tech and leads others to do the same. I love using the enormity of the Internet to bring people together, whether as CTO of Obama for America, CTO at Threadless.com, or on my own projects. You can often find me playing with new technology, looking for something to hack, or enjoying life in Chicago with my amazing wife, Hiromi. Check out my <a href="http://harperreed.com">homepage</a> and <a href="https://twitter.com/intent/follow?screen_name=harper" target="_blank">follow me on twitter</a>.
</div>
      </div>
      <div class="row">
        <div class="offset2 span8 "><div class="post" style="padding-bottom: 50px;">
  <div >
    <h1 ><a title="Permanent Link to Caller id spoofing with PHP and asterisk." href="/2006/02/14/caller-id-spoofing-with-php-and-asterisk/" rel="bookmark">Caller id spoofing with PHP and asterisk</a> <br /><small>Posted on Feb 14, 2006</small></h1>
  </div>
  <div class="postcontent">
    <p>I have cleaned up and commented a little hack i did for my home asterisk server - allowing a person to dial an extension and then be walked through spoofing caller id on a call. It is a ridiculously easy hack to engage. I was surprised and a bit concerned at what this means in regards to trust and telephony. I mean, if a hobbyist is able to spoof caller id on a phone call to anywhere with nothing more than <a href="http://asteriskathome.sourceforge.net/">asterisk@home</a> and <a href="http://www.vmware.com/products/server/">vmware</a>.. what is to stop someone from setting something like this up and stealing credit cards or social security numbers using some crazy <a href="http://en.wikipedia.org/wiki/Social_engineering_%28computer_security%29">social engineering</a>.. i guess nothing..</p>

<p>So anyway, i released <a href="http://asteriskathome.sourceforge.net/">my source code</a>. It is really really simple and based entirely on one small block of code. The basic idea is:</p>

<blockquote><small></small>

<small>
<ol>
    <li>Prompt user for input (spoofed number)</li>
    <li>Grab 10 digits (spoofed number)</li>
    <li>Prompt user for input (number to call)</li>
    <li>Grab 10 digits (number to call)</li>
    <li>Set caller idea based on input in step 1 and 2</li>
    <li>Make call to number from input in step 3 and 4</li>
</ol>
</small></blockquote>


<p>As you can see the idea is pretty simple. get input. set callerid. make call. The code is just as simple:</p>

<blockquote><small><span style="font-style: italic">//(step 1) Prompt user for input</span>
$agi-&gt;stream_file('enter_spoof'); <span style="font-style: italic">//(step 2) Grab 10 digits</span>
$result = $agi-&gt;get_data('beep', 3000, 10);
<span style="font-style: italic">//set variables and output debug info</span>
$spoofnumber= $result['result'];
$agi-&gt;verbose("Spoof Number:".$spoofnumber);</small>

<small><span style="font-style: italic">//(step 3) Prompt user for input</span>
$agi-&gt;stream_file('call_spoof');
<span style="font-style: italic">//(step 4) Grab 10 digits</span>
$result = $agi-&gt;get_data('beep', 3000, 10);
<span style="font-style: italic">//set variables and output debug info</span>
$callnumber= $result['result'];
$agi-&gt;verbose("Number to call:".$callnumber);

<span style="font-style: italic">//(step 5) Set callerid to whatever the input was in step 2</span>
$agi-&gt;set_callerid($spoofnumber);
<span style="font-style: italic">//(step 6) Make call to number from input in step 3 and 4
$agi-&gt;exec("Dial IAX2/yourpassword@provider/1".$callnumber);
</span>

</small></blockquote>


<p>The agi interface to asterisk obviously hides a lot of the complex stuff that asterisk does in the background - but still - the code is insanely simple. even with user interaction. A lot of features could be added - password; callerid checking to make sure only valid users are using the app; call back - so if you call it and set up your spoof, it calls back your number to make sure you who you say you are. or whatever ;) a lot of options are available.
With a little bit of expansion - i think someone could easily make a robust callerid spoofing application for criminals and not criminals.  it is easy enough for anyone to do.</p>

<p>Check out my code here: <a href="http://stuff.harperreed.org/?path=code%2Fasterisk_callerspoof_php&amp;text=asterisk_callerspoof.phps"> asterisk_callerspoof
</a></p>

<p>What i have done is nothing new - there is a great article about all this: <a href="http://www.rootsecure.net/?p=reports/callerid_spoofing">Automated Caller ID / ANI Spoofing</a>
asterisk and php rule.</p>

  </div>
</div>
</div>
      </div>
      <div class="row">
        <div class="offset2 span8 "><hr />

<p><a href="/">nata2.org</a> is &copy; 1997-2014 <a href="https://www.harperreed.com/">Harper Reed</a> (<a href="http://harperreed.org/contact">contact</a>). Powered by <a href="http://jekyllrb.com/">Jekyll</a>, <a href="http://www.vim.org/">vim</a>, <a href="http://en.wikipedia.org/wiki/Amazon_S3">S3</a>, <a href="https://en.wikipedia.org/wiki/Markdown">markdown</a> and magic (mostly magic)</p>
</div>
      </div>
    </div> <!-- /container -->
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.8/jquery-ui.min.js"></script>

<script type="text/javascript" src="http://media.nata2.org/js/scripts.js?9"></script>

 
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-70650-9");
pageTracker._trackPageview();
} catch(err) {}
</script>
 

<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/harper.json?callback=twitterCallback2&amp;count=8"></script>

<script type="text/javascript">
//<![CDATA[
(function() {
    var links = document.getElementsByTagName('a');
    var query = '?';
    for(var i = 0; i < links.length; i++) {
    if(links[i].href.indexOf('#disqus_thread') >= 0) {
        query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
    }
    }
    document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/nata2/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>

<script type="text/javascript">
var _sf_async_config={uid:5483,domain:"nata2.org"};
(function(){
  function loadChartbeat() {
    window._sf_endpt=(new Date()).getTime();
    var e = document.createElement('script');
    e.setAttribute('language', 'javascript');
    e.setAttribute('type', 'text/javascript');
    e.setAttribute('src',
       (("https:" == document.location.protocol) ? "https://s3.amazonaws.com/" : "http://") +
       "static.chartbeat.com/js/chartbeat.js");
    document.body.appendChild(e);
  }
  var oldonload = window.onload;
  window.onload = (typeof window.onload != 'function') ?
     loadChartbeat : function() { oldonload(); loadChartbeat(); };
})();
</script>

  </body>
</html>

</body>
</html>
